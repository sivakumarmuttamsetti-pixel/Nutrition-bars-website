<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Cart Debug Test</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  <script src="script.js" defer></script>
</head>
<body>
  <div class="container mt-5">
    <h1>Cart Debug Test</h1>
    
    <div class="alert alert-info">
      <h4>Debug Information:</h4>
      <ul>
        <li>Current localStorage cart: <span id="current-cart">Loading...</span></li>
        <li>Script loaded: <span id="script-status">Checking...</span></li>
        <li>Buttons found: <span id="buttons-count">Checking...</span></li>
      </ul>
    </div>
    
    <div class="row">
      <div class="col-md-6">
        <div class="card">
          <div class="card-body">
            <h5 class="card-title">Test Product 1</h5>
            <p class="card-text">₹100</p>
            <button 
              class="btn btn-primary add-to-cart" 
              data-name="Test Product 1" 
              data-price="100"
              onclick="debugAddToCart(this)">
              Add to Cart
            </button>
          </div>
        </div>
      </div>
      
      <div class="col-md-6">
        <div class="card">
          <div class="card-body">
            <h5 class="card-title">Test Product 2</h5>
            <p class="card-text">₹150</p>
            <button 
              class="btn btn-primary add-to-cart" 
              data-name="Test Product 2" 
              data-price="150"
              onclick="debugAddToCart(this)">
              Add to Cart
            </button>
          </div>
        </div>
      </div>
    </div>
    
    <div class="mt-4">
      <h3>Cart Contents:</h3>
      <table class="table">
        <thead>
          <tr>
            <th>Product</th>
            <th>Quantity</th>
            <th>Price</th>
            <th>Subtotal</th>
            <th>Action</th>
          </tr>
        </thead>
        <tbody id="cart-items">
          <tr>
            <td colspan="5" class="text-center">Loading...</td>
          </tr>
        </tbody>
      </table>
      
      <h4>Total: <span id="cart-total">₹0</span></h4>
      
      <button class="btn btn-success" onclick="refreshDebugInfo()">Refresh Debug Info</button>
      <button class="btn btn-warning" onclick="clearCart()">Clear Cart</button>
    </div>
  </div>
  
  <script>
    // Debug functions
    function debugAddToCart(button) {
      console.log("Debug: Button clicked", button);
      const name = button.getAttribute("data-name");
      const price = button.getAttribute("data-price");
      console.log("Debug: Adding to cart", name, price);
      
      // Manual add to cart
      try {
        let cart = JSON.parse(localStorage.getItem("cart")) || [];
        console.log("Debug: Current cart before add", cart);
        
        const existing = cart.find(item => item.name === name);
        if (existing) {
          existing.quantity += 1;
        } else {
          cart.push({ name, price: parseFloat(price), quantity: 1 });
        }
        
        localStorage.setItem("cart", JSON.stringify(cart));
        console.log("Debug: Cart after add", cart);
        
        alert(`${name} added to cart!`);
        refreshDebugInfo();
      } catch (error) {
        console.error("Debug: Error adding to cart", error);
        alert("Error: " + error.message);
      }
    }
    
    function refreshDebugInfo() {
      console.log("Debug: Refreshing debug info");
      
      // Check localStorage
      const cart = JSON.parse(localStorage.getItem("cart")) || [];
      document.getElementById("current-cart").textContent = JSON.stringify(cart);
      
      // Check if script is loaded
      const scriptStatus = typeof window.loadCartItems === 'function' ? "✅ Loaded" : "❌ Not loaded";
      document.getElementById("script-status").textContent = scriptStatus;
      
      // Check buttons
      const buttons = document.querySelectorAll(".add-to-cart");
      document.getElementById("buttons-count").textContent = buttons.length;
      
      // Load cart items
      if (typeof window.loadCartItems === 'function') {
        window.loadCartItems();
      } else {
        console.error("Debug: loadCartItems function not found");
      }
    }
    
    // Initialize debug info when page loads
    document.addEventListener("DOMContentLoaded", function() {
      console.log("Debug: DOM loaded");
      setTimeout(refreshDebugInfo, 1000); // Wait 1 second for script to load
    });
  </script>
</body>
</html>